<< # Contract Setup

i = 0;
looking = true;
periods = 1
CN_row = 0;

let CN_drates = "";
let CN_nrates = "";
let CN_erates = "";
let CN_wrates = "";
let CN_startDate = empty;
let CN_tempStartDate = empty;

while (looking) {
    i = i + 1;
    let doubleSiteHeader = row.cSiteHeader + i;
    let prefix = "R" + int.doubleSiteHeader + "C";
    let siteCell = prefix + col.cSiteHeader;
    if (f.siteCell == "" and str.siteCell != "" and str.siteCell != empty) {
        # New contract row
        CN_row = CN_row + 1;
    }

    if (CN_row == CN_Ord) {
        let sdateCell = prefix + col.CStartCol;
        CN_tempStartDate = Contracts.sdateCell;

        let dayRateCell = prefix + col.CBill1Col;       
        let nayRateCell = prefix + col.CBill12ol; 
        # let eayRateCell = prefix + (col.CBill1Col + 4); 
        # let wayRateCell = prefix + (col.CBill1Col + 6);

        if (periods > 1) { 
            if (periods == 2) { 
                CN_nrates = CN_nrates + " (from " + date.CN_startDate + ")\n"; 
                CN_drates = CN_drates + " (from " + date.CN_startDate + ")\n"; 
                # CN_erates = CN_erates + "(from " + date.CN_startDate + ")\n"; 
                # CN_wrates = CN_wrates + "(from " + date.CN_startDate + ")\n"; 
            }
            CN_nrates = CN_nrates + " (from " + date.CN_tempStartDate + ")\n"; 
            CN_drates = CN_drates + " (from " + date.CN_tempStartDate + ")\n"; 
            # CN_erates = CN_erates + "(from " + date.CN_tempStartDate + ")\n"; 
            # CN_wrates = CN_wrates + "(from " + date.CN_tempStartDate + ")\n"; 
        }
        else {
            CN_drates = CN_drates + Contracts.dayRateCell;
            CN_nrates = CN_nrates + Contracts.nayRateCell;
            # CN_erates = CN_erates + Contracts.eayRateCell;
            # CN_wrates = CN_wrates + Contracts.wayRateCell;
            CN_startDate = CN_tempStartDate;
        }

        periods = periods + 1
    }
    else if (CN_row == CN_Ord + 1) {
        looking = false;
    }
}

# After the while loop is completed the following fields are filled:
# - i holds the sheet row of our contract
# - CN_row contains our contract number
# - periods contains the number of different rate period in the contract

"";>>
